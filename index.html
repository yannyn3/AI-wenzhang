<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI文章创作室</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/dompurify@3.0.5/dist/purify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/turndown@7.1.2/dist/turndown.js"></script>
    <!-- 引入API管理器 -->
    <script src="api-manager.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        apple: {
                            blue: '#0071e3',
                            darkblue: '#0077ED',
                            gray: '#f5f5f7',
                            darkgray: '#1d1d1f',
                            midgray: '#86868b',
                            lightgray: '#f2f2f2'
                        }
                    },
                    fontFamily: {
                        apple: ['-apple-system', 'BlinkMacSystemFont', 'San Francisco', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif']
                    },
                    borderRadius: {
                        'xl': '1rem',
                        '2xl': '1.5rem',
                    },
                    boxShadow: {
                        'apple': '0 4px 16px rgba(0, 0, 0, 0.12)',
                        'apple-dark': '0 4px 16px rgba(255, 255, 255, 0.08)'
                    },
                    backdropBlur: {
                        'apple': '20px'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');
        
        /* 基础样式 */
        body {
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            scroll-behavior: smooth;
        }
        
        /* 苹果风格磨砂玻璃效果 */
        .apple-glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        .dark .apple-glass {
            background: rgba(30, 30, 32, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        /* 加载动画 */
        .apple-spinner {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(0, 113, 227, 0.3);
            border-radius: 50%;
            border-top-color: #0071e3;
            animation: spin 1s ease-in-out infinite;
        }
        
        .dark .apple-spinner {
            border: 2px solid rgba(0, 113, 227, 0.2);
            border-top-color: #0077ED;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 文章主题样式 */
        /* 现代简约风 */
        .theme-modern {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            line-height: 1.7;
            color: #333;
        }
        
        .dark .theme-modern {
            color: #e0e0e0;
        }
        
        .theme-modern h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.3;
        }
        
        .theme-modern h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #0071e3;
        }
        
        .dark .theme-modern h2 {
            color: #0077ED;
        }
        
        .theme-modern h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .theme-modern p {
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
        }
        
        .theme-modern img {
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .dark .theme-modern img {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .theme-modern blockquote {
            border-left: 4px solid #0071e3;
            padding: 0.8rem 1rem;
            background-color: rgba(0,113,227,0.05);
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
        }
        
        .dark .theme-modern blockquote {
            background-color: rgba(0,119,237,0.1);
        }
        
        /* 杂志风格 */
        .theme-magazine {
            font-family: Georgia, Times, 'Times New Roman', 'Noto Sans SC', serif;
            line-height: 1.6;
            color: #222;
        }
        
        .dark .theme-magazine {
            color: #f0f0f0;
        }
        
        .theme-magazine h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            line-height: 1.2;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
        }
        
        .theme-magazine h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            border-bottom: 2px solid #333;
            padding-bottom: 0.3rem;
        }
        
        .dark .theme-magazine h2 {
            border-bottom-color: #666;
        }
        
        .theme-magazine h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 1.8rem;
            margin-bottom: 1rem;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
        }
        
        .theme-magazine p {
            margin-bottom: 1.2rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .theme-magazine p:first-of-type::first-letter {
            font-size: 3.5rem;
            float: left;
            line-height: 0.8;
            margin-right: 0.2rem;
            font-weight: bold;
        }
        
        .theme-magazine img {
            margin: 2rem 0;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .dark .theme-magazine img {
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }
        
        .theme-magazine blockquote {
            font-style: italic;
            padding: 1.2rem 1.5rem;
            background-color: #f7f7f7;
            margin: 1.5rem 0;
            border-radius: 8px;
            position: relative;
            font-size: 1.15rem;
        }
        
        .dark .theme-magazine blockquote {
            background-color: #2a2a2a;
        }
        
        .theme-magazine blockquote::before {
            content: '"';
            font-size: 4rem;
            color: #ccc;
            position: absolute;
            left: 10px;
            top: -15px;
        }
        
        /* 科技风格 */
        .theme-tech {
            font-family: 'SF Pro Display', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.7;
            color: #333;
        }
        
        .dark .theme-tech {
            color: #e0e0e0;
        }
        
        .theme-tech h1 {
            font-size: 2.4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            background: linear-gradient(90deg, #0071e3, #00c6fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.3;
        }
        
        .theme-tech h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #0071e3;
        }
        
        .theme-tech h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            color: #444;
        }
        
        .dark .theme-tech h3 {
            color: #ccc;
        }
        
        .theme-tech p {
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
        }
        
        .theme-tech img {
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 8px 30px rgba(0,113,227,0.2);
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .dark .theme-tech img {
            box-shadow: 0 8px 30px rgba(0,119,237,0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .theme-tech blockquote {
            border-left: 4px solid #0071e3;
            padding: 1rem 1.2rem;
            background-color: rgba(0,113,227,0.07);
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .dark .theme-tech blockquote {
            background-color: rgba(0,119,237,0.15);
        }
        
        .theme-tech code {
            background-color: #f0f0f0;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'SF Mono', Menlo, monospace;
            font-size: 0.9em;
        }
        
        .dark .theme-tech code {
            background-color: #2a2a2a;
        }
        
        /* 优雅商务风 */
        .theme-business {
            font-family: 'Georgia', 'Noto Sans SC', serif;
            line-height: 1.6;
            color: #333;
        }
        
        .dark .theme-business {
            color: #e0e0e0;
        }
        
        .theme-business h1 {
            font-size: 2.4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
        }
        
        .dark .theme-business h1 {
            color: #e0e0e0;
            border-bottom-color: #555;
        }
        
        .theme-business h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #2c3e50;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
        }
        
        .dark .theme-business h2 {
            color: #e0e0e0;
        }
        
        .theme-business h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            color: #34495e;
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
        }
        
        .dark .theme-business h3 {
            color: #ccc;
        }
        
        .theme-business p {
            margin-bottom: 1.2rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .theme-business img {
            border-radius: 4px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .dark .theme-business img {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .theme-business blockquote {
            border-left: 3px solid #7f8c8d;
            padding: 1rem 1.2rem;
            background-color: rgba(0,0,0,0.02);
            margin: 1.5rem 0;
            font-style: italic;
        }
        
        .dark .theme-business blockquote {
            background-color: rgba(255,255,255,0.05);
        }
        
        /* 创意设计风 */
        .theme-creative {
            font-family: 'Montserrat', 'Avenir Next', 'Noto Sans SC', sans-serif;
            line-height: 1.7;
            color: #333;
        }
        
        .dark .theme-creative {
            color: #f0f0f0;
        }
        
        .theme-creative h1 {
            font-size: 2.6rem;
            font-weight: 800;
            margin-bottom: 1.8rem;
            color: #ff3366;
            line-height: 1.2;
        }
        
        .dark .theme-creative h1 {
            color: #ff4d7d;
        }
        
        .theme-creative h2 {
            font-size: 1.9rem;
            font-weight: 700;
            margin-top: 2.5rem;
            margin-bottom: 1.2rem;
            color: #ff3366;
            border-bottom: 2px dashed rgba(255,51,102,0.3);
            padding-bottom: 0.3rem;
            display: inline-block;
        }
        
        .dark .theme-creative h2 {
            color: #ff4d7d;
            border-bottom-color: rgba(255,77,125,0.3);
        }
        
        .theme-creative h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 1.8rem;
            margin-bottom: 1rem;
            color: #555;
        }
        
        .dark .theme-creative h3 {
            color: #ddd;
        }
        
        .theme-creative p {
            margin-bottom: 1.3rem;
            font-size: 1.05rem;
            line-height: 1.8;
        }
        
        .theme-creative img {
            border-radius: 20px;
            margin: 2rem auto;
            display: block;
            box-shadow: 0 10px 30px rgba(255,51,102,0.15);
            border: 3px solid white;
        }
        
        .dark .theme-creative img {
            box-shadow: 0 10px 30px rgba(255,77,125,0.2);
            border-color: #333;
        }
        
        .theme-creative blockquote {
            border: none;
            padding: 1.5rem;
            background-color: rgba(255,51,102,0.05);
            margin: 1.8rem 0;
            border-radius: 15px;
            position: relative;
        }
        
        .dark .theme-creative blockquote {
            background-color: rgba(255,77,125,0.1);
        }
        
        .theme-creative blockquote::before {
            content: """;
            font-size: 5rem;
            position: absolute;
            left: 10px;
            top: -20px;
            color: rgba(255,51,102,0.2);
            font-family: Georgia, serif;
        }
        
        .dark .theme-creative blockquote::before {
            color: rgba(255,77,125,0.2);
        }
        
        /* 学术论文风 */
        .theme-academic {
            font-family: 'Times New Roman', Times, 'Noto Sans SC', serif;
            line-height: 1.6;
            color: #222;
        }
        
        .dark .theme-academic {
            color: #eee;
        }
        
        .theme-academic h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 1.2rem;
            text-align: center;
        }
        
        .theme-academic h2 {
            font-size: 1.6rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #ddd;
            padding-bottom: 0.3rem;
        }
        
        .dark .theme-academic h2 {
            border-bottom-color: #555;
        }
        
        .theme-academic h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
            font-style: italic;
        }
        
        .theme-academic p {
            margin-bottom: 1rem;
            font-size: 1.1rem;
            text-align: justify;
            text-indent: 2em;
        }
        
        .theme-academic p:first-of-type {
            text-indent: 0;
        }
        
        .theme-academic img {
            margin: 1.5rem auto;
            display: block;
            max-width: 90%;
            border: 1px solid #ddd;
        }
        
        .dark .theme-academic img {
            border-color: #555;
        }
        
        .theme-academic blockquote {
            border-left: 3px solid #666;
            padding: 0.8rem 1rem;
            background-color: rgba(0,0,0,0.03);
            margin: 1.5rem 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .dark .theme-academic blockquote {
            background-color: rgba(255,255,255,0.03);
        }
        
        /* 自媒体风格 */
        .theme-media {
            font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans SC', sans-serif;
            line-height: 1.8;
            color: #333;
            letter-spacing: 0.5px;
        }
        
        .dark .theme-media {
            color: #eee;
        }
        
        .theme-media h1 {
            font-size: 2.3rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-align: center;
            line-height: 1.4;
            color: #333;
        }
        
        .dark .theme-media h1 {
            color: #fff;
        }
        
        .theme-media h2 {
            font-size: 1.6rem;
            font-weight: 700;
            margin: 1.8rem 0 1rem;
            padding-left: 1rem;
            border-left: 4px solid #07C160;
            line-height: 1.4;
        }
        
        .dark .theme-media h2 {
            border-left-color: #07C160;
        }
        
        .theme-media h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem;
            color: #07C160;
        }
        
        .dark .theme-media h3 {
            color: #07C160;
        }
        
        .theme-media p {
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
            line-height: 1.8;
        }
        
        .theme-media img {
            border-radius: 8px;
            margin: 1.5rem auto;
            display: block;
            max-width: 100%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .dark .theme-media img {
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .theme-media blockquote {
            margin: 1.5rem 0;
            padding: 1rem 1.2rem;
            background-color: #f2f7f2;
            border-radius: 8px;
            font-size: 1rem;
            color: #555;
            line-height: 1.7;
        }
        
        .dark .theme-media blockquote {
            background-color: #2a3a2a;
            color: #ccc;
        }
        
        .theme-media ul, .theme-media ol {
            margin-bottom: 1.2rem;
            padding-left: 1.5rem;
        }
        
        .theme-media ul li, .theme-media ol li {
            margin-bottom: 0.5rem;
        }
        
        .theme-media strong {
            color: #07C160;
            font-weight: 600;
        }
        
        .dark .theme-media strong {
            color: #07C160;
        }
        
        /* 现代博客风格 */
        .theme-blog {
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.8;
            color: #2d3748;
            letter-spacing: 0.3px;
        }
        
        .dark .theme-blog {
            color: #e2e8f0;
        }
        
        .theme-blog h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.3;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        .dark .theme-blog h1 {
            background: linear-gradient(135deg, #818cf8 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        .theme-blog h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 2rem 0 1.2rem;
            color: #4f46e5;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .theme-blog h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 3rem;
            height: 3px;
            background: linear-gradient(90deg, #6366f1, transparent);
        }
        
        .dark .theme-blog h2 {
            color: #818cf8;
        }
        
        .dark .theme-blog h2::after {
            background: linear-gradient(90deg, #818cf8, transparent);
        }
        
        .theme-blog h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 1.8rem 0 1rem;
            color: #4338ca;
        }
        
        .dark .theme-blog h3 {
            color: #a5b4fc;
        }
        
        .theme-blog p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .theme-blog img {
            border-radius: 12px;
            margin: 2rem auto;
            display: block;
            max-width: 100%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .dark .theme-blog img {
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .theme-blog blockquote {
            margin: 2rem 0;
            padding: 1.5rem 2rem;
            background-color: #f8fafc;
            border-left: 4px solid #6366f1;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            position: relative;
        }
        
        .theme-blog blockquote::before {
            content: '"';
            font-size: 4rem;
            font-family: Georgia, serif;
            position: absolute;
            top: -1.5rem;
            left: 0.5rem;
            color: rgba(99, 102, 241, 0.2);
        }
        
        .dark .theme-blog blockquote {
            background-color: #1e293b;
            border-left-color: #818cf8;
        }
        
        .dark .theme-blog blockquote::before {
            color: rgba(129, 140, 248, 0.2);
        }
        
        .theme-blog ul, .theme-blog ol {
            margin-bottom: 1.5rem;
            padding-left: 1.8rem;
        }
        
        .theme-blog ul li, .theme-blog ol li {
            margin-bottom: 0.7rem;
        }
        
        .theme-blog a {
            color: #4f46e5;
            text-decoration: underline;
            text-decoration-thickness: 1px;
            text-underline-offset: 2px;
            transition: all 0.2s ease;
        }
        
        .theme-blog a:hover {
            color: #6366f1;
            text-decoration-thickness: 2px;
        }
        
        .dark .theme-blog a {
            color: #818cf8;
        }
        
        .dark .theme-blog a:hover {
            color: #a5b4fc;
        }
        
        .theme-blog code {
            background-color: #f1f5f9;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'SF Mono', Menlo, monospace;
            font-size: 0.9em;
            color: #4f46e5;
        }
        
        .dark .theme-blog code {
            background-color: #1e293b;
            color: #a5b4fc;
        }
    </style>
</head>
<body class="min-h-screen bg-apple-gray dark:bg-apple-darkgray text-black dark:text-white font-apple transition-colors duration-300">
    <div class="container mx-auto p-4 max-w-6xl">
        <!-- 标题区 -->
        <header class="text-center py-8 mb-8">
            <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-apple-blue to-purple-500 inline-block text-transparent bg-clip-text">
                AI 文章创作室
            </h1>
            <p class="text-apple-midgray dark:text-gray-400 text-lg">使用先进AI技术，创造专业精美的内容</p>
        </header>

        <!-- 主内容区 -->
        <main class="space-y-8">
            <!-- 标签式导航 -->
            <div id="app-tabs" class="flex justify-center mb-6">
                <nav class="flex space-x-2 bg-white dark:bg-apple-darkgray rounded-xl p-1 shadow-sm">
                    <button class="tab-button active px-4 py-2 rounded-lg text-sm font-medium" data-tab="content">
                        <i class="fas fa-pen-fancy mr-2"></i>内容创作
                    </button>
                    <button class="tab-button px-4 py-2 rounded-lg text-sm font-medium" data-tab="api">
                        <i class="fas fa-cog mr-2"></i>API配置
                    </button>
                    <button class="tab-button px-4 py-2 rounded-lg text-sm font-medium" data-tab="preview">
                        <i class="fas fa-eye mr-2"></i>预览排版
                    </button>
                </nav>
            </div>

            <!-- 内容创作面板 -->
            <div id="content-tab" class="tab-content">
                <section class="bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-file-alt mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                        文章信息
                    </h2>
                    
                    <div class="mb-4">
                        <label for="articleTitle" class="block mb-2 font-medium text-gray-700 dark:text-gray-300">文章标题</label>
                        <input type="text" id="articleTitle" placeholder="输入引人注目的标题..." 
                            class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                    </div>
                    
                    <div class="mb-4">
                        <label for="articlePrompt" class="block mb-2 font-medium text-gray-700 dark:text-gray-300">文章提示词</label>
                        <textarea id="articlePrompt" rows="3" placeholder="描述您希望生成的文章风格、内容、结构等..." 
                            class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition"></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">文章长度</label>
                            <div class="flex flex-wrap gap-2">
                                <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                    <input type="radio" name="articleLength" value="short" class="hidden peer" checked>
                                    <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                    </div>
                                    <span>短文 (800-1200字)</span>
                                </label>
                                <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                    <input type="radio" name="articleLength" value="medium" class="hidden peer">
                                    <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                    </div>
                                    <span>中等 (1500-2500字)</span>
                                </label>
                                <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                    <input type="radio" name="articleLength" value="long" class="hidden peer">
                                    <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                    </div>
                                    <span>长文 (3000字以上)</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">排版主题</label>
                            <select id="articleTheme" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                <option value="modern">现代简约风</option>
                                <option value="magazine">杂志排版风</option>
                                <option value="tech">科技风格</option>
                                <option value="business">优雅商务风</option>
                                <option value="creative">创意设计风</option>
                                <option value="academic">学术论文风</option>
                                <option value="media">自媒体风格</option>
                            </select>
                        </div>
                    </div>
                </section>

                <section class="bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-book mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                        参考资料
                    </h2>
                    
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <label for="referenceLinks" class="font-medium text-gray-700 dark:text-gray-300">参考链接 (每行一个)</label>
                            <button id="validateLinksBtn" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline flex items-center">
                                <i class="fas fa-check-circle mr-1"></i>验证链接
                            </button>
                        </div>
                        <textarea id="referenceLinks" rows="2" placeholder="https://example.com/article1&#10;https://example.com/article2" 
                            class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition"></textarea>
                        <div id="linkValidationResult" class="mt-1 hidden"></div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="referenceText" class="block mb-2 font-medium text-gray-700 dark:text-gray-300">参考文本</label>
                        <textarea id="referenceText" rows="4" placeholder="粘贴参考文章文本..." 
                            class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition"></textarea>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <label class="font-medium text-gray-700 dark:text-gray-300">网页导入工具</label>
                            <div class="flex gap-2">
                                <button id="fetchContentBtn" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline flex items-center">
                                    <i class="fas fa-download mr-1"></i>抓取内容
                                </button>
                                <span class="text-gray-400">|</span>
                                <button id="clearResultsBtn" class="text-xs text-red-500 hover:underline flex items-center">
                                    <i class="fas fa-trash mr-1"></i>清空结果
                                </button>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="scrapeUrl" placeholder="输入要抓取的网页URL" 
                                class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                        </div>
                        <div id="scrapeResult" class="mt-2 hidden p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 max-h-40 overflow-auto"></div>
                    </div>
                    
                    <div class="mb-2">
                        <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">参考文件</label>
                        <label for="referenceFiles" class="w-full flex items-center justify-center p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer hover:bg-apple-lightgray dark:hover:bg-gray-800 transition">
                            <div class="text-center">
                                <i class="fas fa-cloud-upload-alt text-xl text-apple-blue dark:text-apple-darkblue mb-2"></i>
                                <p class="text-sm text-gray-600 dark:text-gray-400">点击上传文件或拖拽文件到此处</p>
                                <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">支持 .txt, .docx, .pdf 等文本文件</p>
                            </div>
                            <input id="referenceFiles" type="file" multiple class="hidden">
                        </label>
                        <div id="uploadedFiles" class="mt-2 space-y-1 text-sm"></div>
                    </div>
                </section>

                <section class="bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-image mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                        图片设置
                    </h2>
                    
                    <div class="mb-4">
                        <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">图片来源</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                <input type="radio" name="imageSource" value="extract" class="hidden peer" checked>
                                <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                    <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                </div>
                                <span>从参考链接提取</span>
                            </label>
                            <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                <input type="radio" name="imageSource" value="generate" class="hidden peer">
                                <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                    <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                </div>
                                <span>AI生成图片</span>
                            </label>
                        </div>
                    </div>
                    
                    <div id="imageExtractSettings" class="mb-4">
                        <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">图片插入方式</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                <input type="radio" name="imageInsertMode" value="even" class="hidden peer" checked>
                                <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                    <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                </div>
                                <span>均匀分布</span>
                            </label>
                            <label class="inline-flex items-center px-3 py-2 bg-apple-lightgray dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                                <input type="radio" name="imageInsertMode" value="random" class="hidden peer">
                                <div class="w-4 h-4 mr-2 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center peer-checked:border-apple-blue dark:peer-checked:border-apple-darkblue">
                                    <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden peer-checked:block"></div>
                                </div>
                                <span>随机分布</span>
                            </label>
                        </div>
                    </div>
                    
                    <div id="imageGenerateSettings" class="hidden">
                        <div class="mb-4">
                            <label for="imagePrompt" class="block mb-2 font-medium text-gray-700 dark:text-gray-300">图片提示词</label>
                            <textarea id="imagePrompt" rows="2" placeholder="描述您希望生成的图片内容、风格等..." 
                                class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition"></textarea>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">图片比例</label>
                                <select id="imageAspectRatio" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                    <option value="4:3">4:3 (标准)</option>
                                    <option value="1:1">1:1 (正方形)</option>
                                    <option value="16:9">16:9 (宽屏)</option>
                                    <option value="3:4">3:4 (竖屏)</option>
                                    <option value="9:16">9:16 (手机屏)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block mb-2 font-medium text-gray-700 dark:text-gray-300">图片数量</label>
                            <select id="imageCount" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                <option value="1">1张</option>
                                <option value="2">2张</option>
                                <option value="3" selected>3张</option>
                                <option value="4">4张</option>
                                <option value="5">5张</option>
                                <option value="0">不使用图片</option>
                            </select>
                        </div>
                    </div>
                </section>

                <!-- 行动按钮 -->
                <div class="flex justify-center">
                    <button id="generateBtn" class="py-3 px-8 bg-apple-blue hover:bg-blue-600 dark:bg-apple-darkblue dark:hover:bg-blue-700 text-white rounded-full font-medium text-lg transition-colors shadow-md hover:shadow-lg flex items-center">
                        <i class="fas fa-magic mr-2"></i>
                        创作精彩文章
                    </button>
                </div>
            </div>

            <!-- API配置面板 -->
            <div id="api-tab" class="tab-content hidden">
                <section class="bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-plug mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                        API配置
                    </h2>
                    
                    <!-- 说明信息 -->
                    <div class="bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 rounded-xl p-4 mb-6">
                        <div class="flex items-start">
                            <i class="fas fa-info-circle mt-1 mr-3 text-lg"></i>
                            <div>
                                <p class="mb-2">配置API密钥后，本应用可以在您的网站上独立工作，无需依赖第三方服务。</p>
                                <p>所有API密钥仅存储在您的浏览器中，不会传输到任何服务器。</p>
                            </div>
                        </div>
                    </div>

                    <!-- API 服务商选择 -->
                    <div class="mb-6">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">选择API服务商</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="openai" class="hidden" checked>
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-apple-blue dark:border-apple-darkblue flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">OpenAI</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">GPT-4/3.5等模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://platform.openai.com/api-keys" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="anthropic" class="hidden">
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">Anthropic</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">Claude系列模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://console.anthropic.com/account/keys" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="poe" class="hidden">
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">Poe API</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">Poe平台多种模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://poe.com/api_key" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>

                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="deepseek" class="hidden">
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">DeepSeek</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">深度求索中文大模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://platform.deepseek.com/" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>

                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="baidu" class="hidden">
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">文心一言</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">百度大模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Dlyfpqnlh" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>

                            <div class="api-provider-card">
                                <label class="relative p-4 border border-gray-200 dark:border-gray-700 rounded-xl cursor-pointer hover:border-apple-blue dark:hover:border-apple-darkblue transition-all hover:shadow-md flex flex-col h-full">
                                    <input type="radio" name="apiProvider" value="moonshot" class="hidden">
                                    <div class="absolute top-3 right-3 w-4 h-4 rounded-full border-2 border-gray-300 dark:border-gray-600 flex items-center justify-center provider-radio">
                                        <div class="w-2 h-2 rounded-full bg-apple-blue dark:bg-apple-darkblue hidden provider-radio-dot"></div>
                                    </div>
                                    <h4 class="font-medium mb-1">月之暗面</h4>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">Moonshot系列模型</p>
                                    <div class="mt-auto pt-2 border-t border-gray-100 dark:border-gray-800">
                                        <a href="https://platform.moonshot.cn/console/api-keys" target="_blank" class="text-xs text-apple-blue dark:text-apple-darkblue hover:underline">
                                            获取API密钥 <i class="fas fa-external-link-alt ml-1"></i>
                                        </a>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- OpenAI API设置 -->
                    <div id="openai-settings" class="api-settings mb-6">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">OpenAI设置</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API密钥</label>
                                <input type="password" id="openai-api-key" placeholder="sk-..." 
                                    class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">文章模型</label>
                                    <select id="openai-text-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="gpt-4o">GPT-4o (推荐)</option>
                                        <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">图像模型</label>
                                    <select id="openai-image-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="dall-e-3">DALL·E 3</option>
                                        <option value="dall-e-2">DALL·E 2</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Temperature</label>
                                    <input type="number" id="openai-temperature" min="0" max="2" step="0.1" value="0.7" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Max Tokens</label>
                                    <input type="number" id="openai-max-tokens" min="100" max="16000" step="100" value="4000" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API代理 (可选)</label>
                                    <input type="text" id="openai-api-proxy" placeholder="https://your-proxy-url.com" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Anthropic API设置 -->
                    <div id="anthropic-settings" class="api-settings mb-6 hidden">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">Anthropic设置</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API密钥</label>
                                <input type="password" id="anthropic-api-key" placeholder="sk-ant-..." 
                                    class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">模型</label>
                                    <select id="anthropic-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="claude-3-5-sonnet-20240620">Claude 3.5 Sonnet (推荐)</option>
                                        <option value="claude-3-opus-20240229">Claude 3 Opus</option>
                                        <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
                                        <option value="claude-3-haiku-20240307">Claude 3 Haiku</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API代理 (可选)</label>
                                    <input type="text" id="anthropic-api-proxy" placeholder="https://your-proxy-url.com" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Temperature</label>
                                    <input type="number" id="anthropic-temperature" min="0" max="1" step="0.1" value="0.7" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Max Tokens</label>
                                    <input type="number" id="anthropic-max-tokens" min="100" max="100000" step="100" value="4000" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Top P</label>
                                    <input type="number" id="anthropic-top-p" min="0" max="1" step="0.05" value="0.95" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Poe API设置 -->
                    <div id="poe-settings" class="api-settings mb-6 hidden">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">Poe API设置</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API密钥</label>
                                <input type="password" id="poe-api-key" placeholder="您的Poe API密钥..." 
                                    class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">文章模型</label>
                                    <select id="poe-text-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="Claude-3.7-Sonnet">Claude-3.7-Sonnet (推荐)</option>
                                        <option value="Claude-3-Opus">Claude-3-Opus</option>
                                        <option value="GPT-4o">GPT-4o</option>
                                        <option value="Claude-3-Haiku">Claude-3-Haiku</option>
                                        <option value="GPT-3.5-Turbo">GPT-3.5-Turbo</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">图像模型</label>
                                    <select id="poe-image-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="FLUX-pro-1.1">FLUX-pro-1.1 (推荐)</option>
                                        <option value="DALLE-3">DALL·E 3</option>
                                        <option value="Midjourney">Midjourney</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-xl">
                                <div class="flex">
                                    <i class="fas fa-info-circle mt-1 mr-2"></i>
                                    <div>
                                        <p class="text-sm mb-2">获取Poe API Token的步骤：</p>
                                        <ol class="text-sm list-decimal ml-4 space-y-1">
                                            <li>登录 <a href="https://poe.com" target="_blank" class="underline">poe.com</a></li>
                                            <li>访问 <a href="https://poe.com/api_key" target="_blank" class="underline">https://poe.com/api_key</a></li>
                                            <li>复制生成的API密钥</li>
                                            <li>粘贴到上方的输入框中</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DeepSeek API设置 -->
                    <div id="deepseek-settings" class="api-settings mb-6 hidden">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">DeepSeek设置</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API密钥</label>
                                <input type="password" id="deepseek-api-key" placeholder="sk-..." 
                                    class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">模型</label>
                                    <select id="deepseek-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="deepseek-chat">DeepSeek Chat (推荐)</option>
                                        <option value="deepseek-coder">DeepSeek Coder</option>
                                        <option value="deepseek-lite">DeepSeek Lite</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API代理 (可选)</label>
                                    <input type="text" id="deepseek-api-proxy" placeholder="https://your-proxy-url.com" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Temperature</label>
                                    <input type="number" id="deepseek-temperature" min="0" max="1" step="0.1" value="0.7" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Max Tokens</label>
                                    <input type="number" id="deepseek-max-tokens" min="100" max="8192" step="100" value="4000" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Top P</label>
                                    <input type="number" id="deepseek-top-p" min="0" max="1" step="0.05" value="0.9" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 百度文心一言API设置 -->
                    <div id="baidu-settings" class="api-settings mb-6 hidden">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">百度文心一言设置</h3>
                        <div class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API Key</label>
                                    <input type="password" id="baidu-api-key" placeholder="API Key" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Secret Key</label>
                                    <input type="password" id="baidu-secret-key" placeholder="Secret Key" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">模型</label>
                                    <select id="baidu-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="ernie_speed">文心一言 Speed (推荐)</option>
                                        <option value="ernie-bot-4">文心一言 4.0</option>
                                        <option value="ernie-bot-8k">文心一言 (8K)</option>
                                        <option value="ernie-bot-turbo">文心一言 Turbo</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Temperature</label>
                                    <input type="number" id="baidu-temperature" min="0" max="1" step="0.1" value="0.8" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                            
                            <div class="p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-xl">
                                <div class="flex">
                                    <i class="fas fa-info-circle mt-1 mr-2"></i>
                                    <div>
                                        <p class="text-sm mb-2">获取百度文心一言API密钥的步骤：</p>
                                        <ol class="text-sm list-decimal ml-4 space-y-1">
                                            <li>登录<a href="https://console.bce.baidu.com/qianfan/overview" target="_blank" class="underline">百度智能云千帆平台</a></li>
                                            <li>创建应用，选择文心一言模型</li>
                                            <li>获取API Key和Secret Key</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 月之暗面API设置 -->
                    <div id="moonshot-settings" class="api-settings mb-6 hidden">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3">月之暗面设置</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API密钥</label>
                                <input type="password" id="moonshot-api-key" placeholder="ms-..." 
                                    class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">模型</label>
                                    <select id="moonshot-model" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                        <option value="moonshot-v1-8k">Moonshot v1 8K (推荐)</option>
                                        <option value="moonshot-v1-32k">Moonshot v1 32K</option>
                                        <option value="moonshot-v1-128k">Moonshot v1 128K</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">API代理 (可选)</label>
                                    <input type="text" id="moonshot-api-proxy" placeholder="https://your-proxy-url.com" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Temperature</label>
                                    <input type="number" id="moonshot-temperature" min="0" max="1" step="0.1" value="0.7" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Max Tokens</label>
                                    <input type="number" id="moonshot-max-tokens" min="100" max="8000" step="100" value="4000" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                                
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Top P</label>
                                    <input type="number" id="moonshot-top-p" min="0" max="1" step="0.05" value="0.95" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 自部署说明 -->
                    <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-4 mb-6">
                        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center">
                            <i class="fas fa-server mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                            网站部署说明
                        </h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">本应用可以轻松部署到您自己的网站上：</p>
                        <ol class="text-sm text-gray-600 dark:text-gray-400 space-y-2 pl-5 list-decimal">
                            <li>复制本页面全部HTML代码</li>
                            <li>创建一个新的HTML文件并粘贴代码</li>
                            <li>配置您的API密钥</li>
                            <li>上传到您的网站服务器或静态托管服务</li>
                        </ol>
                    </div>
                    
                    <div class="flex justify-center">
                        <button id="saveApiSettingsBtn" class="py-2 px-6 bg-apple-blue hover:bg-blue-600 dark:bg-apple-darkblue dark:hover:bg-blue-700 text-white rounded-full font-medium transition-colors shadow-md hover:shadow-lg">
                            保存API配置
                        </button>
                    </div>

                    <!-- API测试状态 -->
                    <div id="apiTestResult" class="mt-4 hidden"></div>
                </section>
            </div>

            <!-- 预览排版面板 -->
            <div id="preview-tab" class="tab-content hidden">
                <!-- 生成状态 -->
                <div id="generationStatus" class="py-4 px-6 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-xl text-center mb-6 hidden">
                    <div class="flex items-center justify-center space-x-3">
                        <div class="apple-spinner"></div>
                        <span id="statusText">正在创作精彩内容...</span>
                    </div>
                </div>

                <!-- 排版主题展示 -->
                <div id="themeShowcase" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow theme-card-selected" data-theme="modern">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">现代简约风</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-modern scale-[0.6] origin-top-left">
                                <h1>现代简约风格标题</h1>
                                <p>这是一款专为现代数字体验设计的排版风格，特点是清晰的层次结构和优雅的视觉表现。</p>
                                <h2>小标题展示</h2>
                                <p>简洁的段落文字与优雅的间距搭配，让阅读体验更加舒适。适合各类专业文章和技术内容。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="magazine">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">杂志排版风</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-magazine scale-[0.6] origin-top-left">
                                <h1>杂志风格大标题</h1>
                                <p>杂志风格的排版设计灵感来源于印刷媒体，强调优雅的文字处理和精致的细节。</p>
                                <h2>精致的小标题</h2>
                                <p>这种风格特别适合长篇故事和深度报道，首字下沉效果增添了专业感和阅读趣味。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="tech">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">科技风格</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-tech scale-[0.6] origin-top-left">
                                <h1>科技风格醒目标题</h1>
                                <p>科技风格采用现代感十足的渐变色彩和清晰的字体层次，展现前沿科技的视觉效果。</p>
                                <h2>功能性小标题</h2>
                                <p>特别适合科技博客、产品介绍和技术文档，内置代码样式和专业的引用框设计。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="business">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">优雅商务风</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-business scale-[0.6] origin-top-left">
                                <h1>优雅商务风格标题</h1>
                                <p>商务风格采用沉稳专业的排版，适合正式场合的商业内容和专业报告。</p>
                                <h2>业务部分标题</h2>
                                <p>结构清晰，重点突出，为读者提供专业且易于理解的阅读体验，尤其适合公司白皮书和商业分析。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="creative">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">创意设计风</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-creative scale-[0.6] origin-top-left">
                                <h1>创意风格大标题</h1>
                                <p>创意设计风格活泼生动，色彩丰富，让内容具有艺术感和吸引力。</p>
                                <h2>灵感部分</h2>
                                <p>独特的排版和装饰元素让文章充满设计感，特别适合创意行业、艺术评论和时尚内容。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="academic">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">学术论文风</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-academic scale-[0.6] origin-top-left">
                                <h1>学术研究标题</h1>
                                <p>学术风格注重内容的严谨性和结构化表达，遵循学术规范的排版原则。</p>
                                <h2>研究方法</h2>
                                <p>首行缩进和引用格式符合学术要求，特别适合研究报告、学术论文和教育内容的呈现。</p>
                            </div>
                        </div>
                    </div>
                    <div class="theme-card bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark overflow-hidden cursor-pointer hover:ring-2 ring-apple-blue dark:ring-apple-darkblue transition-shadow" data-theme="media">
                        <div class="p-4 border-b border-gray-100 dark:border-gray-800 font-medium">自媒体风格</div>
                        <div class="p-4 h-48 overflow-hidden">
                            <div class="theme-media scale-[0.6] origin-top-left">
                                <h1>自媒体文章标题</h1>
                                <p>自媒体风格注重视觉吸引力和易读性，适合在各大平台发布的内容。</p>
                                <h2>引人入胜的小标题</h2>
                                <p>醒目的标题、清晰的层级和强调的重点，让读者快速获取信息，适合微信公众号和其他自媒体平台。</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 输出预览 -->
                <section id="outputSection" class="bg-white dark:bg-gray-900 rounded-2xl shadow-apple dark:shadow-apple-dark p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-newspaper mr-2 text-apple-blue dark:text-apple-darkblue"></i>
                            文章预览
                        </h2>
                        <div class="flex gap-2">
                            <button id="editArticleBtn" class="py-1.5 px-3 text-sm bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg transition-colors flex items-center">
                                <i class="fas fa-edit mr-1.5"></i>编辑
                            </button>
                            <button id="regenerateBtn" class="py-1.5 px-3 text-sm bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg transition-colors flex items-center">
                                <i class="fas fa-sync-alt mr-1.5"></i>重新生成
                            </button>
                            <button id="copyBtn" class="py-1.5 px-3 text-sm bg-apple-blue hover:bg-blue-600 dark:bg-apple-darkblue dark:hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center">
                                <i class="fas fa-copy mr-1.5"></i>复制文章
                            </button>
                        </div>
                    </div>
                    
                    <div id="articleOutput" class="theme-modern prose dark:prose-invert max-w-none border border-gray-100 dark:border-gray-800 p-6 rounded-xl bg-white dark:bg-gray-950 overflow-auto"></div>
                    
                    <!-- 生成的图片区域 -->
                    <div id="generatedImages" class="mt-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 hidden">
                        <h3 class="text-lg font-semibold col-span-full mb-2 flex items-center">
                            <i class="fas fa-images mr-2 text-apple-blue dark:text-apple-darkblue"></i>生成的图片
                        </h3>
                        <!-- 生成的图片将在这里显示 -->
                    </div>
                </section>
                
                <!-- 编辑文章对话框 -->
                <div id="editArticleModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden backdrop-blur-sm">
                    <div class="bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-auto shadow-xl animate-fade-in">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold">编辑文章内容</h3>
                            <button id="closeEditBtn" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                                <i class="fas fa-times text-lg"></i>
                            </button>
                        </div>
                        <div class="mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <label class="font-medium text-gray-700 dark:text-gray-300">Markdown 编辑</label>
                                <div class="flex gap-2">
                                    <button id="formatBoldBtn" class="p-1.5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded">
                                        <i class="fas fa-bold"></i>
                                    </button>
                                    <button id="formatItalicBtn" class="p-1.5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded">
                                        <i class="fas fa-italic"></i>
                                    </button>
                                    <button id="formatLinkBtn" class="p-1.5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded">
                                        <i class="fas fa-link"></i>
                                    </button>
                                    <button id="formatH2Btn" class="p-1.5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded">
                                        <i class="fas fa-heading"></i>
                                    </button>
                                    <button id="formatQuoteBtn" class="p-1.5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded">
                                        <i class="fas fa-quote-right"></i>
                                    </button>
                                </div>
                            </div>
                            <textarea id="articleEditArea" rows="20" class="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-apple-lightgray dark:bg-gray-800 text-base focus:ring-2 focus:ring-apple-blue dark:focus:ring-apple-darkblue focus:border-transparent outline-none transition font-mono"></textarea>
                        </div>
                        <div class="flex justify-end gap-3">
                            <button id="cancelEditBtn" class="py-2 px-4 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg transition-colors">
                                取消
                            </button>
                            <button id="saveEditBtn" class="py-2 px-4 bg-apple-blue hover:bg-blue-600 dark:bg-apple-darkblue dark:hover:bg-blue-700 text-white rounded-lg transition-colors">
                                保存更改
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="mt-12 text-center text-apple-midgray dark:text-gray-500 text-sm py-4">
            <p>© 2024 AI文章创作室 - 使用先进AI技术创建专业内容</p>
        </footer>
    </div>

    <script>
        // 检测暗色模式
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // API配置持久化
        const API_CONFIG_KEY = 'ai_writer_api_config';
        
        // 加载保存的API配置
        function loadApiConfig() {
            const savedConfig = localStorage.getItem(API_CONFIG_KEY);
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    
                    // 设置选中的API提供商
                    const providerRadio = document.querySelector(`input[name="apiProvider"][value="${config.provider}"]`);
                    if (providerRadio) {
                        providerRadio.checked = true;
                        // 手动设置单选按钮的样式
                        updateProviderRadioStyle(providerRadio);
                        // 触发提供商切换事件
                        toggleApiSettings(config.provider);
                    }
                    
                    // OpenAI配置
                    if (config.openai) {
                        document.getElementById('openai-api-key').value = config.openai.apiKey || '';
                        document.getElementById('openai-text-model').value = config.openai.textModel || 'gpt-4o';
                        document.getElementById('openai-image-model').value = config.openai.imageModel || 'dall-e-3';
                        document.getElementById('openai-temperature').value = config.openai.temperature || 0.7;
                        document.getElementById('openai-max-tokens').value = config.openai.maxTokens || 4000;
                        document.getElementById('openai-api-proxy').value = config.openai.apiProxy || '';
                    }
                    
                    // Anthropic配置
                    if (config.anthropic) {
                        document.getElementById('anthropic-api-key').value = config.anthropic.apiKey || '';
                        document.getElementById('anthropic-model').value = config.anthropic.model || 'claude-3-5-sonnet-20240620';
                        document.getElementById('anthropic-temperature').value = config.anthropic.temperature || 0.7;
                        document.getElementById('anthropic-max-tokens').value = config.anthropic.maxTokens || 4000;
                        document.getElementById('anthropic-top-p').value = config.anthropic.topP || 0.95;
                        document.getElementById('anthropic-api-proxy').value = config.anthropic.apiProxy || '';
                    }
                    
                    // Poe配置
                    if (config.poe) {
                        document.getElementById('poe-api-key').value = config.poe.apiKey || '';
                        document.getElementById('poe-text-model').value = config.poe.textModel || 'Claude-3.7-Sonnet';
                        document.getElementById('poe-image-model').value = config.poe.imageModel || 'FLUX-pro-1.1';
                    }
                    
                    // DeepSeek配置
                    if (config.deepseek) {
                        document.getElementById('deepseek-api-key').value = config.deepseek.apiKey || '';
                        document.getElementById('deepseek-model').value = config.deepseek.model || 'deepseek-chat';
                        document.getElementById('deepseek-temperature').value = config.deepseek.temperature || 0.7;
                        document.getElementById('deepseek-max-tokens').value = config.deepseek.maxTokens || 4000;
                        document.getElementById('deepseek-top-p').value = config.deepseek.topP || 0.9;
                        document.getElementById('deepseek-api-proxy').value = config.deepseek.apiProxy || '';
                    }
                    
                    // 百度文心一言配置
                    if (config.baidu) {
                        document.getElementById('baidu-api-key').value = config.baidu.apiKey || '';
                        document.getElementById('baidu-secret-key').value = config.baidu.secretKey || '';
                        document.getElementById('baidu-model').value = config.baidu.model || 'ernie_speed';
                        document.getElementById('baidu-temperature').value = config.baidu.temperature || 0.8;
                    }
                    
                    // 月之暗面配置
                    if (config.moonshot) {
                        document.getElementById('moonshot-api-key').value = config.moonshot.apiKey || '';
                        document.getElementById('moonshot-model').value = config.moonshot.model || 'moonshot-v1-8k';
                        document.getElementById('moonshot-temperature').value = config.moonshot.temperature || 0.7;
                        document.getElementById('moonshot-max-tokens').value = config.moonshot.maxTokens || 4000;
                        document.getElementById('moonshot-top-p').value = config.moonshot.topP || 0.95;
                        document.getElementById('moonshot-api-proxy').value = config.moonshot.apiProxy || '';
                    }
                } catch (error) {
                    console.error("加载API配置时出错:", error);
                }
            }
        }
        
        // 保存API配置
        function saveApiConfig() {
            const provider = document.querySelector('input[name="apiProvider"]:checked').value;
            
            const config = {
                provider,
                openai: {
                    apiKey: document.getElementById('openai-api-key').value,
                    textModel: document.getElementById('openai-text-model').value,
                    imageModel: document.getElementById('openai-image-model').value,
                    temperature: parseFloat(document.getElementById('openai-temperature').value),
                    maxTokens: parseInt(document.getElementById('openai-max-tokens').value),
                    apiProxy: document.getElementById('openai-api-proxy').value
                },
                anthropic: {
                    apiKey: document.getElementById('anthropic-api-key').value,
                    model: document.getElementById('anthropic-model').value,
                    temperature: parseFloat(document.getElementById('anthropic-temperature').value),
                    maxTokens: parseInt(document.getElementById('anthropic-max-tokens').value),
                    topP: parseFloat(document.getElementById('anthropic-top-p').value),
                    apiProxy: document.getElementById('anthropic-api-proxy').value
                },
                poe: {
                    apiKey: document.getElementById('poe-api-key').value,
                    textModel: document.getElementById('poe-text-model').value,
                    imageModel: document.getElementById('poe-image-model').value
                },
                deepseek: {
                    apiKey: document.getElementById('deepseek-api-key').value,
                    model: document.getElementById('deepseek-model').value,
                    temperature: parseFloat(document.getElementById('deepseek-temperature').value),
                    maxTokens: parseInt(document.getElementById('deepseek-max-tokens').value),
                    topP: parseFloat(document.getElementById('deepseek-top-p').value),
                    apiProxy: document.getElementById('deepseek-api-proxy').value
                },
                baidu: {
                    apiKey: document.getElementById('baidu-api-key').value,
                    secretKey: document.getElementById('baidu-secret-key').value,
                    model: document.getElementById('baidu-model').value,
                    temperature: parseFloat(document.getElementById('baidu-temperature').value)
                },
                moonshot: {
                    apiKey: document.getElementById('moonshot-api-key').value,
                    model: document.getElementById('moonshot-model').value,
                    temperature: parseFloat(document.getElementById('moonshot-temperature').value),
                    maxTokens: parseInt(document.getElementById('moonshot-max-tokens').value),
                    topP: parseFloat(document.getElementById('moonshot-top-p').value),
                    apiProxy: document.getElementById('moonshot-api-proxy').value
                }
            };
            
            localStorage.setItem(API_CONFIG_KEY, JSON.stringify(config));
            return config;
        }
        
        // 测试API配置
        async function testApiConfig() {
            const provider = document.querySelector('input[name="apiProvider"]:checked').value;
            const apiTestResult = document.getElementById('apiTestResult');
            
            apiTestResult.innerHTML = `
                <div class="p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-xl flex items-center">
                    <div class="apple-spinner mr-2"></div>
                    <span>正在测试 ${provider} API 连接...</span>
                </div>
            `;
            apiTestResult.classList.remove('hidden');
            
            try {
                // 根据不同的提供商进行测试
                let testResult = false;
                
                switch (provider) {
                    case 'openai':
                        const openaiKey = document.getElementById('openai-api-key').value;
                        if (!openaiKey) {
                            throw new Error("请输入OpenAI API密钥");
                        }
                        
                        // 在实际应用中应该调用实际API进行测试
                        // 这里模拟测试结果
                        testResult = openaiKey.startsWith('sk-');
                        break;
                        
                    case 'anthropic':
                        const anthropicKey = document.getElementById('anthropic-api-key').value;
                        if (!anthropicKey) {
                            throw new Error("请输入Anthropic API密钥");
                        }
                        
                        testResult = anthropicKey.startsWith('sk-ant');
                        break;
                        
                    case 'poe':
                        const poeKey = document.getElementById('poe-api-key').value;
                        if (!poeKey) {
                            throw new Error("请输入Poe API密钥");
                        }
                        
                        // Poe API应该至少有36个字符
                        testResult = poeKey.length >= 36;
                        break;
                        
                    case 'deepseek':
                        const deepseekKey = document.getElementById('deepseek-api-key').value;
                        if (!deepseekKey) {
                            throw new Error("请输入DeepSeek API密钥");
                        }
                        
                        testResult = deepseekKey.length > 20;
                        break;
                        
                    case 'baidu':
                        const baiduApiKey = document.getElementById('baidu-api-key').value;
                        const baiduSecretKey = document.getElementById('baidu-secret-key').value;
                        if (!baiduApiKey || !baiduSecretKey) {
                            throw new Error("请输入百度文心一言API Key和Secret Key");
                        }
                        
                        testResult = baiduApiKey.length > 10 && baiduSecretKey.length > 10;
                        break;
                        
                    case 'moonshot':
                        const moonshotKey = document.getElementById('moonshot-api-key').value;
                        if (!moonshotKey) {
                            throw new Error("请输入月之暗面API密钥");
                        }
                        
                        testResult = moonshotKey.startsWith('ms-');
                        break;
                }
                
                // 延时模拟API调用
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                if (testResult) {
                    apiTestResult.innerHTML = `
                        <div class="p-3 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 rounded-xl flex items-center">
                            <i class="fas fa-check-circle mr-2"></i>
                            <span>${provider} API 连接测试成功！</span>
                        </div>
                    `;
                } else {
                    throw new Error("API测试失败，请检查密钥格式是否正确");
                }
            } catch (error) {
                apiTestResult.innerHTML = `
                    <div class="p-3 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 rounded-xl flex items-center">
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        <span>错误: ${error.message}</span>
                    </div>
                `;
            }
        }

        // 标签页切换
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                // 移除所有active类
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active', 'bg-white', 'dark:bg-gray-800', 'shadow-sm');
                    btn.classList.add('text-gray-500', 'dark:text-gray-400');
                });
                
                // 隐藏所有内容
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // 激活当前标签
                button.classList.add('active', 'bg-white', 'dark:bg-gray-800', 'shadow-sm');
                button.classList.remove('text-gray-500', 'dark:text-gray-400');
                
                // 显示当前内容
                const tabId = button.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.remove('hidden');
            });
        });
        
        // 设置API提供商卡片样式
        function updateProviderRadioStyle(radio) {
            // 获取所有提供商卡片
            document.querySelectorAll('.api-provider-card').forEach(card => {
                const cardRadio = card.querySelector('input[type="radio"]');
                const radioOutline = card.querySelector('.provider-radio');
                const radioDot = card.querySelector('.provider-radio-dot');
                
                // 重置样式
                radioOutline.classList.remove('border-apple-blue', 'dark:border-apple-darkblue');
                radioOutline.classList.add('border-gray-300', 'dark:border-gray-600');
                radioDot.classList.add('hidden');
                card.querySelector('label').classList.remove('border-apple-blue', 'dark:border-apple-darkblue');
            });
            
            // 设置选中的提供商卡片样式
            const card = radio.closest('.api-provider-card');
            const radioOutline = card.querySelector('.provider-radio');
            const radioDot = card.querySelector('.provider-radio-dot');
            
            radioOutline.classList.remove('border-gray-300', 'dark:border-gray-600');
            radioOutline.classList.add('border-apple-blue', 'dark:border-apple-darkblue');
            radioDot.classList.remove('hidden');
            card.querySelector('label').classList.add('border-apple-blue', 'dark:border-apple-darkblue');
        }
        
        // API提供商选择切换
        document.querySelectorAll('.api-provider-card input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // 更新单选按钮样式
                updateProviderRadioStyle(this);
                
                // 切换API设置面板
                const provider = this.value;
                toggleApiSettings(provider);
                
                // 隐藏测试结果
                document.getElementById('apiTestResult').classList.add('hidden');
            });
        });
        
        function toggleApiSettings(provider) {
            // 隐藏所有API设置
            document.querySelectorAll('.api-settings').forEach(setting => {
                setting.classList.add('hidden');
            });
            
            // 显示选中的API设置
            document.getElementById(`${provider}-settings`).classList.remove('hidden');
        }
        
        // 主题卡片选择
        document.querySelectorAll('.theme-card').forEach(card => {
            card.addEventListener('click', function() {
                // 取消所有卡片选择
                document.querySelectorAll('.theme-card').forEach(c => {
                    c.classList.remove('theme-card-selected', 'ring-2');
                });
                
                // 选中当前卡片
                this.classList.add('theme-card-selected', 'ring-2');
                
                // 更新主题选择下拉框
                const themeValue = this.getAttribute('data-theme');
                document.getElementById('articleTheme').value = themeValue;
                
                // 更新文章预览区域的主题
                if (document.getElementById('articleOutput')) {
                    document.getElementById('articleOutput').className = '';
                    document.getElementById('articleOutput').classList.add(
                        `theme-${themeValue}`, 
                        'prose', 'dark:prose-invert', 'max-w-none', 
                        'border', 'border-gray-100', 'dark:border-gray-800', 
                        'p-6', 'rounded-xl', 'bg-white', 'dark:bg-gray-950', 
                        'overflow-auto'
                    );
                }
            });
        });
        
        // 下拉框主题选择与卡片联动
        document.getElementById('articleTheme').addEventListener('change', function() {
            const selectedTheme = this.value;
            
            // 更新主题卡片选择
            document.querySelectorAll('.theme-card').forEach(card => {
                if (card.getAttribute('data-theme') === selectedTheme) {
                    card.click();
                }
            });
        });

        // 参考链接验证
        document.getElementById('validateLinksBtn').addEventListener('click', async function() {
            const links = document.getElementById('referenceLinks').value;
            const resultDiv = document.getElementById('linkValidationResult');
            
            if (!links.trim()) {
                resultDiv.innerHTML = `
                    <div class="text-yellow-600 dark:text-yellow-400 text-sm flex items-center">
                        <i class="fas fa-exclamation-triangle mr-1"></i>
                        <span>请输入至少一个网址进行验证</span>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                return;
            }
            
            // 显示加载状态
            resultDiv.innerHTML = `
                <div class="text-blue-600 dark:text-blue-400 text-sm flex items-center">
                    <div class="apple-spinner mr-2"></div>
                    <span>正在验证链接可访问性...</span>
                </div>
            `;
            resultDiv.classList.remove('hidden');
            
            const linkList = links.split('\n').filter(link => link.trim());
            const results = [];
            
            for (const link of linkList) {
                if (!link.trim()) continue;
                
                try {
                    // 实际应用中需要替换成实际的链接检查逻辑
                    // 这里简单模拟
                    const isValid = link.startsWith('http') || link.startsWith('https');
                    const hasImages = Math.random() > 0.3; // 模拟图片检测结果
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    results.push({
                        link,
                        isValid,
                        hasImages,
                        error: isValid ? null : "无效的URL格式"
                    });
                } catch (error) {
                    results.push({
                        link,
                        isValid: false,
                        hasImages: false,
                        error: error.message
                    });
                }
            }
            
            // 显示结果
            resultDiv.innerHTML = `
                <div class="text-sm mt-2">
                    <h4 class="font-medium mb-1">验证结果:</h4>
                    <ul class="space-y-1">
                        ${results.map(result => `
                            <li class="flex items-center">
                                <span class="${result.isValid ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}">
                                    <i class="fas fa-${result.isValid ? 'check-circle' : 'times-circle'} mr-1"></i>
                                </span>
                                <span class="truncate" title="${result.link}">${result.link}</span>
                                ${result.isValid ? 
                                    `<span class="ml-2 ${result.hasImages ? 'text-green-600 dark:text-green-400' : 'text-yellow-600 dark:text-yellow-400'} text-xs">
                                        ${result.hasImages ? '含图片' : '未检测到图片'}
                                    </span>` : 
                                    `<span class="ml-2 text-red-600 dark:text-red-400 text-xs">${result.error}</span>`
                                }
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
        });

        // 网页内容抓取功能
        document.getElementById('fetchContentBtn').addEventListener('click', async function() {
            const url = document.getElementById('scrapeUrl').value;
            const resultDiv = document.getElementById('scrapeResult');
            
            if (!url.trim()) {
                resultDiv.innerHTML = `
                    <div class="text-yellow-600 dark:text-yellow-400 text-sm">
                        请输入要抓取的网页URL
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                return;
            }
            
            // 显示加载状态
            resultDiv.innerHTML = `
                <div class="text-blue-600 dark:text-blue-400 text-sm flex items-center">
                    <div class="apple-spinner mr-2"></div>
                    <span>正在抓取网页内容...</span>
                </div>
            `;
            resultDiv.classList.remove('hidden');
            
            try {
                // 实际应用中，应该调用API或后端服务来抓取网页内容
                // 这里简单模拟抓取结果
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // 模拟抓取失败的情况
                if (Math.random() > 0.7) {
                    throw new Error('无法访问该网页，请检查URL或尝试其他网页');
                }
                
                // 随机生成模拟内容
                const content = `这是从 ${url} 抓取的内容示例。

在实际应用中，这里将显示从目标网页提取的有效文本内容。抓取工具会自动过滤掉网页中的广告、导航栏等无关内容，只保留主要的文章正文、标题和相关信息。

您可以将这些内容用作参考资料，直接用于生成文章，或进行编辑后再使用。`;
                
                // 更新结果显示
                resultDiv.innerHTML = `
                    <div class="text-gray-700 dark:text-gray-300 text-sm">
                        <div class="flex justify-between mb-2">
                            <span class="font-medium text-green-600 dark:text-green-400">
                                <i class="fas fa-check-circle mr-1"></i>抓取成功
                            </span>
                            <button id="useContentBtn" class="text-apple-blue dark:text-apple-darkblue hover:underline flex items-center text-xs">
                                <i class="fas fa-plus-circle mr-1"></i>添加到参考文本
                            </button>
                        </div>
                        <div class="max-h-36 overflow-y-auto p-2 bg-gray-50 dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700">
                            ${content.replace(/\n/g, '<br>')}
                        </div>
                    </div>
                `;
                
                // 添加使用内容按钮事件
                document.getElementById('useContentBtn').addEventListener('click', function() {
                    const referenceText = document.getElementById('referenceText');
                    referenceText.value += (referenceText.value ? '\n\n' : '') + content;
                });
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="text-red-600 dark:text-red-400 text-sm flex items-start">
                        <i class="fas fa-exclamation-circle mt-1 mr-2"></i>
                        <div>
                            <p class="font-medium">抓取失败</p>
                            <p class="mt-1">${error.message}</p>
                            <p class="mt-2 text-xs">可能的原因:</p>
                            <ul class="list-disc ml-4 mt-1 text-xs">
                                <li>URL格式不正确</li>
                                <li>网站阻止了抓取</li>
                                <li>网站需要登录或会员</li>
                                <li>网络连接问题</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
        });
        
        // 清空抓取结果
        document.getElementById('clearResultsBtn').addEventListener('click', function() {
            document.getElementById('scrapeResult').classList.add('hidden');
            document.getElementById('scrapeUrl').value = '';
        });

        // 文件上传处理
        document.getElementById('referenceFiles').addEventListener('change', function(e) {
            const uploadedFilesDiv = document.getElementById('uploadedFiles');
            uploadedFilesDiv.innerHTML = '';
            
            Array.from(this.files).forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'flex items-center justify-between py-1.5 px-3 bg-apple-lightgray dark:bg-gray-800 rounded-lg';
                fileItem.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-file-alt text-apple-blue dark:text-apple-darkblue mr-2"></i>
                        <span class="text-sm truncate max-w-[200px]">${file.name}</span>
                        <span class="text-xs text-gray-500 ml-2">(${(file.size / 1024).toFixed(1)} KB)</span>
                    </div>
                    <button class="remove-file text-gray-400 hover:text-red-500">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                uploadedFilesDiv.appendChild(fileItem);
            });
            
            // 为移除按钮添加事件
            document.querySelectorAll('.remove-file').forEach(button => {
                button.addEventListener('click', function() {
                    this.closest('div').remove();
                });
            });
        });

        // 图片来源切换
        document.querySelectorAll('input[name="imageSource"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'extract') {
                    document.getElementById('imageExtractSettings').classList.remove('hidden');
                    document.getElementById('imageGenerateSettings').classList.add('hidden');
                } else if (this.value === 'generate') {
                    document.getElementById('imageExtractSettings').classList.add('hidden');
                    document.getElementById('imageGenerateSettings').classList.remove('hidden');
                }
            });
        });

        // Markdown编辑工具栏功能
        function wrapSelectedText(textarea, beforeText, afterText) {
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            const replacement = beforeText + selectedText + afterText;
            
            textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);
            
            // 恢复选择区域
            textarea.focus();
            textarea.setSelectionRange(start + beforeText.length, start + beforeText.length + selectedText.length);
        }
        
        document.getElementById('formatBoldBtn')?.addEventListener('click', function() {
            const textarea = document.getElementById('articleEditArea');
            wrapSelectedText(textarea, '**', '**');
        });
        
        document.getElementById('formatItalicBtn')?.addEventListener('click', function() {
            const textarea = document.getElementById('articleEditArea');
            wrapSelectedText(textarea, '*', '*');
        });
        
        document.getElementById('formatLinkBtn')?.addEventListener('click', function() {
            const textarea = document.getElementById('articleEditArea');
            wrapSelectedText(textarea, '[', '](https://example.com)');
        });
        
        document.getElementById('formatH2Btn')?.addEventListener('click', function() {
            const textarea = document.getElementById('articleEditArea');
            const start = textarea.selectionStart;
            const lineStart = textarea.value.lastIndexOf('\n', start - 1) + 1;
            const beforeText = textarea.value.substring(0, lineStart);
            const afterText = textarea.value.substring(lineStart);
            
            textarea.value = beforeText + '## ' + afterText;
            textarea.focus();
            textarea.setSelectionRange(lineStart + 3, lineStart + 3);
        });
        
        document.getElementById('formatQuoteBtn')?.addEventListener('click', function() {
            const textarea = document.getElementById('articleEditArea');
            const start = textarea.selectionStart;
            const lineStart = textarea.value.lastIndexOf('\n', start - 1) + 1;
            const beforeText = textarea.value.substring(0, lineStart);
            const afterText = textarea.value.substring(lineStart);
            
            textarea.value = beforeText + '> ' + afterText;
            textarea.focus();
            textarea.setSelectionRange(lineStart + 2, lineStart + 2);
        });

        // 从参考链接提取图片
        async function extractImagesFromLinks(links, count) {
            const statusText = document.getElementById('statusText');
            statusText.textContent = '正在从参考链接提取图片...';
            
            try {
                const linkList = links.split('\n').filter(link => link.trim());
                if (linkList.length === 0) {
                    throw new Error("未提供有效的参考链接");
                }
                
                // 检查链接是否可访问
                const invalidLinks = [];
                for (const link of linkList) {
                    // 简单验证URL格式
                    if (!link.startsWith('http://') && !link.startsWith('https://')) {
                        invalidLinks.push(`${link} - 不是有效的URL格式`);
                        continue;
                    }
                    
                    // 在实际应用中，这里应该发送请求验证链接是否可访问
                    // 简单模拟
                    if (Math.random() > 0.7) {
                        invalidLinks.push(`${link} - 无法访问此链接`);
                    }
                }
                
                if (invalidLinks.length === linkList.length) {
                    throw new Error("所有链接均无法访问，请检查链接是否有效");
                }
                
                // 使用大模型提取图片
                const apiConfig = JSON.parse(localStorage.getItem(API_CONFIG_KEY) || '{}');
                const provider = apiConfig.provider || 'openai';
                
                // 在实际应用中，这里应该调用API提取图片URL
                // 模拟提取结果
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // 模拟图片URL列表
                const extractedUrls = [
                    'https://images.unsplash.com/photo-1637603626000-735ed926ed4e',
                    'https://images.unsplash.com/photo-1531297484001-80022131f5a1',
                    'https://images.unsplash.com/photo-1637603626000-735ed926ed4e',
                    'https://images.unsplash.com/photo-1499951360447-b19be8fe80f5',
                    'https://images.unsplash.com/photo-1515378960530-7c0da6231fb1'
                ];
                
                if (Math.random() > 0.8) {
                    // 模拟未找到图片的情况
                    throw new Error("未在参考链接中找到可用的图片");
                }
                
                // 只返回需要的数量
                return extractedUrls.slice(0, count);
                
            } catch (error) {
                console.error("提取图片错误:", error);
                document.getElementById('generationStatus').classList.add('hidden');
                
                // 显示错误提示
                const alertDiv = document.createElement('div');
                alertDiv.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
                alertDiv.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl max-w-lg w-full shadow-xl">
                        <h3 class="text-xl font-semibold mb-4 flex items-center text-red-600 dark:text-red-400">
                            <i class="fas fa-exclamation-circle mr-2"></i>链接图片提取失败
                        </h3>
                        <p class="mb-4">无法从提供的链接中提取图片，可能的原因：</p>
                        <ul class="list-disc pl-5 mb-4">
                            <li>链接不可访问或已失效</li>
                            <li>链接中不包含可提取的图片</li>
                            <li>链接网站限制了图片访问</li>
                            <li>网站需要登录或会员才能访问内容</li>
                        </ul>
                        <p class="mb-4">建议尝试：</p>
                        <ul class="list-disc pl-5 mb-6">
                            <li>使用"验证链接"功能检查链接可访问性</li>
                            <li>尝试其他包含图片的链接</li>
                            <li>切换到AI生成图片模式</li>
                        </ul>
                        <div class="flex justify-end">
                            <button id="closeAlertBtn" class="px-4 py-2 bg-apple-blue text-white rounded-lg">
                                我知道了
                            </button>
                        </div>
                    </div>
                `;
                document.body.appendChild(alertDiv);
                
                // 添加关闭按钮事件
                document.getElementById('closeAlertBtn').addEventListener('click', () => {
                    document.body.removeChild(alertDiv);
                });
                
                return [];
            }
        }

        // 将图片插入到文章中
        function insertImagesIntoArticle(images, insertMode) {
            const articleOutput = document.getElementById('articleOutput');
            const paragraphs = articleOutput.querySelectorAll('p, h2, h3');
            
            if (paragraphs.length === 0 || images.length === 0) return;
            
            if (insertMode === 'even') {
                // 均匀分布插入
                const step = Math.floor(paragraphs.length / (images.length + 1));
                let positions = [];
                
                for (let i = 1; i <= images.length; i++) {
                    let pos = i * step;
                    if (pos >= paragraphs.length) pos = paragraphs.length - 1;
                    positions.push(pos);
                }
                
                // 插入图片
                positions.forEach((position, index) => {
                    if (index < images.length && position < paragraphs.length) {
                        const imgElement = document.createElement('img');
                        imgElement.src = images[index];
                        imgElement.alt = '文章配图';
                        imgElement.className = 'mx-auto my-4 max-w-full h-auto';
                        
                        paragraphs[position].parentNode.insertBefore(imgElement, paragraphs[position].nextSibling);
                    }
                });
            } else {
                // 随机分布插入
                let availablePositions = [...Array(paragraphs.length).keys()];
                let positions = [];
                
                // 随机选择位置
                for (let i = 0; i < images.length; i++) {
                    if (availablePositions.length === 0) break;
                    
                    const randomIndex = Math.floor(Math.random() * availablePositions.length);
                    positions.push(availablePositions[randomIndex]);
                    availablePositions.splice(randomIndex, 1);
                }
                
                // 排序位置，从后往前插入，避免位置变化
                positions.sort((a, b) => b - a);
                
                // 插入图片
                positions.forEach((position, index) => {
                    if (index < images.length && position < paragraphs.length) {
                        const imgElement = document.createElement('img');
                        imgElement.src = images[index];
                        imgElement.alt = '文章配图';
                        imgElement.className = 'mx-auto my-4 max-w-full h-auto';
                        
                        paragraphs[position].parentNode.insertBefore(imgElement, paragraphs[position].nextSibling);
                    }
                });
            }
        }

        // 生成图片
        async function generateImages() {
            const imageSource = document.querySelector('input[name="imageSource"]:checked').value;
            const imageCount = parseInt(document.getElementById('imageCount').value);
            const statusText = document.getElementById('statusText');
            const generatedImages = document.getElementById('generatedImages');
            
            if (imageCount <= 0) return;
            
            if (imageSource === 'extract') {
                // 从参考链接提取图片
                const referenceLinks = document.getElementById('referenceLinks').value;
                if (!referenceLinks.trim()) {
                    // 显示警告提示
                    document.getElementById('generationStatus').classList.add('hidden');
                    
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
                    alertDiv.innerHTML = `
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl max-w-lg w-full shadow-xl">
                            <h3 class="text-xl font-semibold mb-4 flex items-center text-yellow-600 dark:text-yellow-400">
                                <i class="fas fa-exclamation-triangle mr-2"></i>缺少参考链接
                            </h3>
                            <p class="mb-4">您选择了从参考链接提取图片，但未提供任何参考链接。</p>
                            <p class="mb-6">请在参考资料部分添加至少一个包含图片的网页链接，或者切换到AI生成图片模式。</p>
                            <div class="flex justify-end">
                                <button id="closeAlertBtn" class="px-4 py-2 bg-apple-blue text-white rounded-lg">
                                    我知道了
                                </button>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(alertDiv);
                    
                    // 添加关闭按钮事件
                    document.getElementById('closeAlertBtn').addEventListener('click', () => {
                        document.body.removeChild(alertDiv);
                    });
                    
                    return;
                }
                
                // 提取图片
                const extractedImages = await extractImagesFromLinks(referenceLinks, imageCount);
                
                if (extractedImages.length > 0) {
                    // 显示提取的图片
                    generatedImages.innerHTML = '<h3 class="text-lg font-semibold col-span-full mb-2 flex items-center"><i class="fas fa-images mr-2 text-apple-blue dark:text-apple-darkblue"></i>提取的图片</h3>';
                    generatedImages.classList.remove('hidden');
                    
                    // 添加图片到展示区
                    extractedImages.forEach((imageUrl, index) => {
                        const container = document.createElement('div');
                        container.className = 'relative group overflow-hidden rounded-xl';
                        
                        const img = document.createElement('img');
                        img.src = imageUrl;
                        img.className = 'w-full h-auto rounded-xl transition-all duration-300';
                        img.alt = `提取的图片 ${index + 1}`;
                        img.onerror = function() {
                            // 图片加载失败时显示错误提示
                            this.onerror = null;
                            this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMDAgMjAwIj48cmVjdCBmaWxsPSIjZGRkIiB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIvPjx0ZXh0IGZpbGw9IiM5OTkiIGZvbnQtZmFtaWx5PSJBcmlhbCxzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiB4PSI1MCUiIHk9IjUwJSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPuWbvueJh+WKoui9veWksei0pTwvdGV4dD48L3N2Zz4=';
                            this.className = 'w-full h-auto rounded-xl bg-gray-200 dark:bg-gray-700';
                        };
                        
                        const overlay = document.createElement('div');
                        overlay.className = 'absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300';
                        
                        const btnContainer = document.createElement('div');
                        btnContainer.className = 'flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0';
                        
                        const insertBtn = document.createElement('button');
                        insertBtn.className = 'bg-apple-blue hover:bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium';
                        insertBtn.innerHTML = '<i class="fas fa-plus mr-1"></i>插入';
                        insertBtn.addEventListener('click', () => {
                            // 在文章末尾插入图片
                            const articleContent = document.getElementById('articleOutput');
                            const imgElement = document.createElement('img');
                            imgElement.src = imageUrl;
                            imgElement.alt = '文章配图';
                            imgElement.className = 'mx-auto my-4 max-w-full h-auto';
                            articleContent.appendChild(imgElement);
                        });
                        
                        btnContainer.appendChild(insertBtn);
                        overlay.appendChild(btnContainer);
                        container.appendChild(img);
                        container.appendChild(overlay);
                        
                        generatedImages.appendChild(container);
                    });
                    
                    // 添加自动插入图片功能
                    const insertMode = document.querySelector('input[name="imageInsertMode"]:checked').value;
                    insertImagesIntoArticle(extractedImages, insertMode);
                    
                    document.getElementById('generationStatus').classList.add('hidden');
                }
            } else {
                // AI生成图片
                const apiConfig = JSON.parse(localStorage.getItem(API_CONFIG_KEY) || '{}');
                const provider = apiConfig.provider || 'openai';
                
                // 根据不同的提供商获取图片模型
                let imageModel;
                
                switch (provider) {
                    case 'openai':
                        imageModel = apiConfig.openai?.imageModel || 'dall-e-3';
                        break;
                    case 'poe':
                        imageModel = apiConfig.poe?.imageModel || 'FLUX-pro-1.1';
                        break;
                    default:
                        imageModel = 'FLUX-pro-1.1'; // 默认
                }
                
                const imagePrompt = document.getElementById('imagePrompt').value || "适合文章的精美配图，高质量，专业，逼真";
                const aspectRatio = document.getElementById('imageAspectRatio').value;
                
                // 清空之前的图片
                generatedImages.innerHTML = '<h3 class="text-lg font-semibold col-span-full mb-2 flex items-center"><i class="fas fa-images mr-2 text-apple-blue dark:text-apple-darkblue"></i>生成的图片</h3>';
                generatedImages.classList.remove('hidden');
                
                // 显示生成状态
                document.getElementById('generationStatus').classList.remove('hidden');
                statusText.textContent = '正在创作精美图片...';
                
                // 创建占位符
                for (let i = 0; i < imageCount; i++) {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'bg-gray-100 dark:bg-gray-800 rounded-xl aspect-[4/3] animate-pulse flex items-center justify-center';
                    placeholder.id = `img-placeholder-${i}`;
                    placeholder.innerHTML = '<div class="text-gray-400 dark:text-gray-500 flex flex-col items-center"><i class="fas fa-image mb-2 text-xl"></i><span>生成中...</span></div>';
                    generatedImages.appendChild(placeholder);
                }
                
                // 生成图片
                try {
                    // 在实际应用中，这里应该调用API生成图片
                    // 模拟生成过程
                    const generatedUrls = [];
                    
                    for (let i = 0; i < imageCount; i++) {
                        // 延时模拟生成过程
                        await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                        
                        // 随机选择一个样例图片URL
                        const sampleUrls = [
                            'https://images.unsplash.com/photo-1507146426996-ef05306b995a',
                            'https://images.unsplash.com/photo-1639322537504-6427a16b0a28',
                            'https://images.unsplash.com/photo-1683009427619-c5b89223646f',
                            'https://images.unsplash.com/photo-1581092918056-0c4c3acd3789',
                            'https://images.unsplash.com/photo-1517245386807-bb43f82c33c4'
                        ];
                        
                        const imageUrl = sampleUrls[Math.floor(Math.random() * sampleUrls.length)];
                        generatedUrls.push(imageUrl);
                        
                        // 更新占位符
                        const placeholder = document.getElementById(`img-placeholder-${i}`);
                        if (placeholder) {
                            const container = document.createElement('div');
                            container.className = 'relative group overflow-hidden rounded-xl';
                            
                            const img = document.createElement('img');
                            img.src = imageUrl;
                            img.className = 'w-full h-auto rounded-xl transition-all duration-300';
                            img.alt = `生成的图片 ${i + 1}`;
                            
                            const overlay = document.createElement('div');
                            overlay.className = 'absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300';
                            
                            const btnContainer = document.createElement('div');
                            btnContainer.className = 'flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0';
                            
                            const insertBtn = document.createElement('button');
                            insertBtn.className = 'bg-apple-blue hover:bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium';
                            insertBtn.innerHTML = '<i class="fas fa-plus mr-1"></i>插入';
                            insertBtn.addEventListener('click', () => {
                                // 在文章末尾插入图片
                                const articleContent = document.getElementById('articleOutput');
                                const imgElement = document.createElement('img');
                                imgElement.src = imageUrl;
                                imgElement.alt = '文章配图';
                                imgElement.className = 'mx-auto my-4 max-w-full h-auto';
                                articleContent.appendChild(imgElement);
                            });
                            
                            const downloadBtn = document.createElement('button');
                            downloadBtn.className = 'bg-white hover:bg-gray-100 text-gray-800 px-3 py-1.5 rounded-lg text-sm font-medium';
                            downloadBtn.innerHTML = '<i class="fas fa-download mr-1"></i>保存';
                            downloadBtn.addEventListener('click', () => {
                                // 提示用户如何保存图片
                                alert('请在图片上右键点击并选择"图片另存为..."以保存图片。');
                            });
                            
                            btnContainer.appendChild(insertBtn);
                            btnContainer.appendChild(downloadBtn);
                            overlay.appendChild(btnContainer);
                            container.appendChild(img);
                            container.appendChild(overlay);
                            
                            placeholder.replaceWith(container);
                        }
                    }
                    
                    // 添加自动插入图片功能
                    const insertMode = document.querySelector('input[name="imageInsertMode"]:checked').value;
                    insertImagesIntoArticle(generatedUrls, insertMode);
                    
                } catch (error) {
                    console.error("生成图片错误:", error);
                    // 显示错误提示
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
                    alertDiv.innerHTML = `
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl max-w-lg w-full shadow-xl">
                            <h3 class="text-xl font-semibold mb-4 flex items-center text-red-600 dark:text-red-400">
                                <i class="fas fa-exclamation-circle mr-2"></i>图片生成失败
                            </h3>
                            <p class="mb-4">无法使用AI生成图片，可能的原因：</p>
                            <ul class="list-disc pl-5 mb-4">
                                <li>API密钥配置错误或已过期</li>
                                <li>提示词包含不当内容</li>
                                <li>API服务暂时不可用</li>
                                <li>网络连接问题</li>
                            </ul>
                            <p class="mb-4">建议尝试：</p>
                            <ul class="list-disc pl-5 mb-6">
                                <li>检查API配置并重试</li>
                                <li>修改图片提示词</li>
                                <li>切换到参考链接提取图片模式</li>
                            </ul>
                            <div class="flex justify-end">
                                <button id="closeAlertBtn" class="px-4 py-2 bg-apple-blue text-white rounded-lg">
                                    我知道了
                                </button>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(alertDiv);
                    
                    // 添加关闭按钮事件
                    document.getElementById('closeAlertBtn').addEventListener('click', () => {
                        document.body.removeChild(alertDiv);
                    });
                } finally {
                    document.getElementById('generationStatus').classList.add('hidden');
                    
                    // 移除任何剩余的占位符
                    document.querySelectorAll('[id^="img-placeholder-"]').forEach(placeholder => {
                        placeholder.remove();
                    });
                }
            }
        }

        // 生成示例文章 - 在实际应用中应通过API替换
        async function simulateGenerateArticle(title, prompt, length) {
            // 这里应该是通过API调用来生成文章
            // 现在仅作为演示返回示例文章
            
            const articleTheme = document.getElementById('articleTheme').value;
            let themeDesc = '';
            
            switch (articleTheme) {
                case 'modern': themeDesc = '现代简约风格'; break;
                case 'magazine': themeDesc = '杂志排版风格'; break;
                case 'tech': themeDesc = '科技风格'; break;
                case 'business': themeDesc = '商务风格'; break;
                case 'creative': themeDesc = '创意设计风格'; break;
                case 'academic': themeDesc = '学术论文风格'; break;
                case 'media': themeDesc = '自媒体风格'; break;
            }
            
            let lengthDesc = '';
            switch (length) {
                case 'short': lengthDesc = '短文'; break;
                case 'medium': lengthDesc = '中等长度'; break;
                case 'long': lengthDesc = '长文'; break;
            }
            
            return `# ${title || '人工智能如何改变我们的生活与工作方式'}

## 引言：科技变革的新篇章

在当今数字化时代，人工智能（AI）正以前所未有的速度重塑我们的生活方式和工作环境。从智能手机上的语音助手到复杂的预测分析系统，AI技术已经深入渗透到我们日常生活的方方面面。本文将探讨AI如何改变我们的生活和工作，以及这些变化对社会带来的深远影响。

## AI在日常生活中的应用

人工智能已经成为我们日常生活中不可或缺的一部分。智能家居设备可以根据我们的习惯自动调节温度和照明；语音助手可以帮助我们设置提醒、播放音乐或回答问题；推荐算法则根据我们的喜好推荐电影、音乐和新闻。

> "人工智能不仅仅是一项技术，它正在成为我们生活方式的延伸。" —— 未来学家雷·库兹韦尔

这些技术的一个关键优势是它们能够学习和适应用户的偏好。例如，流媒体服务越了解你的观看习惯，它提供的推荐就越能符合你的口味。这种个性化体验是AI最引人注目的特点之一。

## 工作环境的革命性变化

在职场中，AI正在改变几乎所有行业的工作方式：

1. **自动化日常任务** - 从数据输入到客户服务，AI可以处理重复性任务，使员工能够专注于更具创造性和战略性的工作。
2. **增强决策过程** - 通过分析大量数据，AI可以提供洞察力，帮助决策者做出更明智的选择。
3. **创造新的工作岗位** - 尽管有些职位可能会被自动化取代，但AI也创造了新的工作岗位，如AI伦理专家、机器学习工程师等。

## 挑战与考虑

然而，AI的迅速发展也带来了一系列需要我们认真思考的挑战：

* **隐私和数据安全** - AI系统需要大量数据才能有效运行，这引发了关于数据收集和使用的隐私问题。
* **工作岗位变化** - 某些工作可能会被自动化，需要员工学习新技能来适应不断变化的就业市场。
* **算法偏见** - 如果训练数据存在偏见，AI系统可能会继承并放大这些偏见，导致不公平的结果。

## 未来展望

展望未来，人工智能将继续以创新的方式融入我们的生活和工作。关键在于我们如何管理这一转变，确保技术服务于人类的最佳利益，同时减轻潜在的负面影响。

通过适当的政策、教育和伦理框架，我们可以利用AI的力量来创造一个更高效、更公平的社会，让每个人都能从这一技术革命中受益。

## 结论

人工智能正在彻底改变我们生活和工作的方式，为我们提供前所未有的便利和效率。虽然这一旅程充满挑战，但通过负责任的创新和协作，我们可以塑造一个AI技术与人类价值共存的未来。

作为这场技术革命的参与者，我们每个人都有责任了解AI的潜力和局限性，并确保它的发展方向符合社会的集体利益。这是一项正在进行中的工作，需要我们所有人的参与和思考。`;
        }

        // 生成文章功能
        document.getElementById('generateBtn')?.addEventListener('click', async function() {
            const generationStatus = document.getElementById('generationStatus');
            const statusText = document.getElementById('statusText');
            const outputSection = document.getElementById('outputSection');
            
            // 切换到预览标签页
            document.querySelector('[data-tab="preview"]').click();
            
            // 显示生成状态
            generationStatus.classList.remove('hidden');
            statusText.textContent = '正在收集创作素材...';
            outputSection.classList.add('hidden');
            
            this.disabled = true;
            this.innerHTML = '<div class="apple-spinner mr-2"></div>创作中...';
            
            try {
                // 收集表单数据
                const title = document.getElementById('articleTitle').value;
                const articlePrompt = document.getElementById('articlePrompt').value;
                const referenceLinks = document.getElementById('referenceLinks').value;
                const referenceText = document.getElementById('referenceText').value;
                const articleLength = document.querySelector('input[name="articleLength"]:checked').value;
                const articleTheme = document.getElementById('articleTheme').value;
                
                // 加载API配置
                const apiConfig = JSON.parse(localStorage.getItem(API_CONFIG_KEY) || '{}');
                const provider = apiConfig.provider || 'openai';
                
                // 验证API配置
                switch (provider) {
                    case 'openai':
                        if (!apiConfig.openai?.apiKey) {
                            throw new Error("请先配置OpenAI API密钥");
                        }
                        break;
                    case 'anthropic':
                        if (!apiConfig.anthropic?.apiKey) {
                            throw new Error("请先配置Anthropic API密钥");
                        }
                        break;
                    case 'poe':
                        if (!apiConfig.poe?.apiKey) {
                            throw new Error("请先配置Poe API密钥");
                        }
                        break;
                    case 'deepseek':
                        if (!apiConfig.deepseek?.apiKey) {
                            throw new Error("请先配置DeepSeek API密钥");
                        }
                        break;
                    case 'baidu':
                        if (!apiConfig.baidu?.apiKey || !apiConfig.baidu?.secretKey) {
                            throw new Error("请先配置百度文心一言API Key和Secret Key");
                        }
                        break;
                    case 'moonshot':
                        if (!apiConfig.moonshot?.apiKey) {
                            throw new Error("请先配置月之暗面API密钥");
                        }
                        break;
                }
                
                // 使用大模型生成文章
                statusText.textContent = '正在创作文章内容...';
                
                // 在实际项目中，这里应该调用对应的API
                const articleContent = await simulateGenerateArticle(title, articlePrompt, articleLength);
                
                // 显示文章内容
                const articleOutput = document.getElementById('articleOutput');
                articleOutput.innerHTML = DOMPurify.sanitize(marked.parse(articleContent));
                
                // 应用选中的主题
                articleOutput.className = '';
                articleOutput.classList.add(
                    `theme-${articleTheme}`, 
                    'prose', 'dark:prose-invert', 'max-w-none', 
                    'border', 'border-gray-100', 'dark:border-gray-800', 
                    'p-6', 'rounded-xl', 'bg-white', 'dark:bg-gray-950', 
                    'overflow-auto'
                );
                
                outputSection.classList.remove('hidden');
                
                // 处理图片生成或提取
                await generateImages();
                
                generationStatus.classList.add('hidden');
                this.disabled = false;
                this.innerHTML = '<i class="fas fa-magic mr-2"></i>创作精彩文章';
                
                // 滚动到输出部分
                outputSection.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                generationStatus.classList.add('hidden');
                
                // 显示错误提示
                const alertDiv = document.createElement('div');
                alertDiv.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
                alertDiv.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl max-w-lg w-full shadow-xl">
                        <h3 class="text-xl font-semibold mb-4 flex items-center text-red-600 dark:text-red-400">
                            <i class="fas fa-exclamation-circle mr-2"></i>文章生成失败
                        </h3>
                        <p class="mb-4">${error.message}</p>
                        <div class="flex justify-end">
                            <button id="closeAlertBtn" class="px-4 py-2 bg-apple-blue text-white rounded-lg">
                                我知道了
                            </button>
                        </div>
                    </div>
                `;
                document.body.appendChild(alertDiv);
                
                // 添加关闭按钮事件
                document.getElementById('closeAlertBtn').addEventListener('click', () => {
                    document.body.removeChild(alertDiv);
                });
                
                this.disabled = false;
                this.innerHTML = '<i class="fas fa-magic mr-2"></i>创作精彩文章';
            }
        });

        // 复制按钮
        document.getElementById('copyBtn')?.addEventListener('click', function() {
            const articleOutput = document.getElementById('articleOutput');
            
            // 创建一个临时元素用于选择和复制
            const tempElement = document.createElement('div');
            tempElement.innerHTML = articleOutput.innerHTML;
            
            document.body.appendChild(tempElement);
            tempElement.style.position = 'absolute';
            tempElement.style.left = '-9999px';
            tempElement.style.opacity = '0';
            
            // 选择并复制
            const range = document.createRange();
            range.selectNodeContents(tempElement);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            document.execCommand('copy');
            
            // 清理
            selection.removeAllRanges();
            document.body.removeChild(tempElement);
            
            // 显示成功提示
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-check mr-1.5"></i>已复制!';
            setTimeout(() => {
                this.innerHTML = originalText;
            }, 2000);
        });

        // 编辑文章模态框
        const editModal = document.getElementById('editArticleModal');
        
        document.getElementById('editArticleBtn')?.addEventListener('click', function() {
            const articleOutput = document.getElementById('articleOutput');
            const turndownService = new TurndownService();
            const markdown = turndownService.turndown(articleOutput.innerHTML);
            
            document.getElementById('articleEditArea').value = markdown;
            editModal.classList.remove('hidden');
        });
        
        document.getElementById('closeEditBtn')?.addEventListener('click', () => {
            editModal.classList.add('hidden');
        });
        
        document.getElementById('cancelEditBtn')?.addEventListener('click', () => {
            editModal.classList.add('hidden');
        });
        
        document.getElementById('saveEditBtn')?.addEventListener('click', function() {
            const articleOutput = document.getElementById('articleOutput');
            const markdownContent = document.getElementById('articleEditArea').value;
            articleOutput.innerHTML = DOMPurify.sanitize(marked.parse(markdownContent));
            editModal.classList.add('hidden');
        });
        
        // 重新生成按钮
        document.getElementById('regenerateBtn')?.addEventListener('click', function() {
            // 切换到内容创作页面
            document.querySelector('[data-tab="content"]').click();
            // 点击生成按钮
            document.getElementById('generateBtn').click();
        });
        
        // 保存API设置按钮
        document.getElementById('saveApiSettingsBtn')?.addEventListener('click', async function() {
            // 保存API配置
            saveApiConfig();
            
            // 测试API连接
            await testApiConfig();
            
            // 显示成功提示
            const originalText = this.textContent;
            this.innerHTML = '<i class="fas fa-check mr-2"></i>设置已保存';
            this.classList.add('bg-green-600', 'dark:bg-green-700');
            
            setTimeout(() => {
                this.textContent = originalText;
                this.classList.remove('bg-green-600', 'dark:bg-green-700');
                
                // 切换到内容创作页面
                document.querySelector('[data-tab="content"]').click();
            }, 2000);
        });
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始设置为第一个标签页激活
            document.querySelector('.tab-button').click();
            
            // 加载保存的API配置
            loadApiConfig();
            
            // 设置radio按钮选中状态
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                if (radio.checked) {
                    // 如果是API提供商单选按钮
                    if (radio.name === 'apiProvider') {
                        const card = radio.closest('.api-provider-card');
                        if (card) {
                            card.querySelector('.provider-radio').classList.remove('border-gray-300', 'dark:border-gray-600');
                            card.querySelector('.provider-radio').classList.add('border-apple-blue', 'dark:border-apple-darkblue');
                            card.querySelector('.provider-radio-dot').classList.remove('hidden');
                            card.querySelector('label').classList.add('border-apple-blue', 'dark:border-apple-darkblue');
                        }
                    } else {
                        // 其他单选按钮
                        const dot = radio.closest('label').querySelector('.w-2.h-2');
                        if (dot) dot.classList.remove('hidden');
                    }
                }
            });
        });
    </script>
</body>
</html>
